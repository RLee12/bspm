function [rb se2] =ipctb_ustat(s, sInfo);% send data matrix: rows = voxels and cols = pairwise corrs %nvox = size(s,1);n2   = size(s,2);               % n choose 2 rows %nt   = (1+sqrt(1+8*n2))/2;      % n               %n3   = nt*(nt-1)*(nt-2)/6;      % n choose 3      %z1   = zeros(nvox,1);rb   = mean(s,2); h = waitbar(0,['Statistics for ' sInfo]);for a = 1:nvox   rs = s(a,:);                % rows are voxels %   rp = zeros(nt,nt);      ac = 1:(nt-1);              % create r matrix from indexed vector %   for c = 1:(nt-1);        rp(c,(c+1):nt) = rs(ac);      ac = max(ac) + ( 1: (length(ac)-1) );    end;      z1(a) = 0;    for i = 1:(nt-2);       for j = (i+1):(nt-1);           for k = (j+1):nt;                    z1(a) = z1(a)+ rp(i,j)*rp(i,k)+ rp(i,j)*rp(j,k)+ rp(i,k)*rp(j,k);           end;       end;   end;   waitbar(a/nvox,h);end;close(h);z1    = z1./(3.*n3) - rb.*rb;z1    = max(0,z1);se2   =  4*z1./nt + 2*(var(s,1,2))./(nt*(nt-1));             % var for u-stat  %